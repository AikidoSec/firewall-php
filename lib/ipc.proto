syntax = "proto3";

import "google/protobuf/empty.proto";

package ipc;

option go_package = "ipc/protos;protos";

service Aikido {
  rpc OnDomain (Domain) returns (google.protobuf.Empty);
  rpc OnRequest (RequestMetadata) returns (RequestStatus);
  rpc GetCloudConfig(google.protobuf.Empty) returns (CloudConfig);
}

message Domain {
  string domain = 1;
}

message RequestMetadata {
  string method = 1;
  string route = 2;
}

message RateLimiting {
  bool enabled = 1;
}

message Endpoint {
  string method = 1;
  string route = 2;
  bool forceProtectionOff = 3;
  RateLimiting rateLimiting = 4;
}

message CloudConfig {
  repeated Endpoint endpoints = 1;
  repeated string blockedUserIds = 2;
  repeated string allowedIPAddresses = 3;
}

message RequestStatus {
  bool forwardToServer = 1;
}